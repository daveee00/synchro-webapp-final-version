<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"
    />
    <meta name="format-detection" content="telephone=no" />

    <title>zero hour day</title>

    <link rel="stylesheet" href="./style/variables.css" />
    <link rel="stylesheet" href="./index.css" />
    <link rel="stylesheet" href="./style/load.css" />
    <!-- style subsections -->
    <link rel="stylesheet" href="./style/align.css" />
    <link rel="stylesheet" href="./style/world-rank.css" />
    <link rel="stylesheet" href="./style/recap-lock.css" />
    <link rel="stylesheet" href="./style/recap-unlock.css" />
    <!-- style subsections -->
    <link rel="stylesheet" href="./style/subsections/align-subsection.css" />
    <link rel="stylesheet" href="./style/subsections/world-subsection.css" />
    <link
      rel="stylesheet"
      href="./style/subsections/recap-unlock-subsection.css"
    />
    <!-- style others -->
    <link rel="stylesheet" href="./style/animation.css" />
    <link rel="stylesheet" href="./style/tests.css" />
    <link rel="stylesheet" href="./style/more-about.css" />

    <!-- font webkit -->
    <link rel="stylesheet" href="https://use.typekit.net/onf3tub.css" />
  </head>

  <body>
    <section id="load-page">
      <div class="load-wrap">
        <div class="logo-wrap">
          <div class="central-block">
            <div class="logo" data-svg="./public/icons/logo-un.svg">
              <div class="svg-holder left"></div>
            </div>
            <div class="divider"></div>
            <div class="logo" data-svg="./public/icons/logo-zhd-day.svg">
              <div class="svg-holder right"></div>
            </div>
          </div>
        </div>
        <div class="powered-by">
          Powered by&nbsp;<span style="letter-spacing: -3%; font-weight: 200"
            >SYNCHRO</span
          >
        </div>
      </div>
    </section>
    <!--
      =======================
      header
      =======================
      -->
    <header>
      <div class="page-head divide">
        <button
          class="id-space"
          id="copyUrlBtn"
          data-svg="./public/icons/profile.svg"
        >
          <span class="svg-holder"></span>
          <div class="id-number" id="user-id">0123456789</div>
        </button>
        <div class="timer-space">
          <div class="timer-text">voting closes in:</div>
          <div class="timer" id="timer">00:00:00</div>
        </div>
      </div>
      <nav class="divide">
        <button data-view="alignment" class="align-nav-btn" id="align-nav-btn">
          align
        </button>
        <button data-view="world" class="world-nav-btn" id="world-nav-btn">
          world
        </button>
        <button data-view="recap-lock" class="recap-nav-btn" id="recap-nav-btn">
          recap
        </button>
      </nav>
    </header>

    <main>
      <section id="alignment" class="view active">
        <div class="content">
          <div class="alignment-content">
            <div class="align-graphic">
              <div
                class="external-graphic"
                data-svg="./public/icons/raggiera.svg"
              >
                <span class="svg-holder"></span>
              </div>
              <div
                class="internal-graphic"
                data-svg="./public/icons/raggiera.svg"
              >
                <span class="svg-holder"></span>
              </div>
            </div>
            <div class="align-values">
              <button
                class="value"
                id="personal-value-btn"
                data-view="align-personal-overlay"
              >
                <div class="value-name hl-sweep">your alignment ❯</div>
                <div class="value-percentage">63,9%</div>
              </button>
              <div class="line-vertical"></div>
              <button
                class="value"
                id="country-value-btn"
                data-view="align-country-overlay"
              >
                <div class="value-name hl-sweep">nation alignment ❯</div>
                <div class="value-percentage">71,9%</div>
              </button>
            </div>
          </div>
          <div class="comment-section-wrap">
            <div class="comment-content">
              You are currently undeperforming. You're 13% below your country's
              average.
            </div>
          </div>
        </div>

        <footer>
          <button class="overlay-open-btn" data-view="more-about-personal">
            more about ▴
          </button>
        </footer>
      </section>

      <!--
      =======================
      world section
      =======================
      -->
      <section id="world" class="view">
        <div class="content">
          <div
            class="visual-map-content"
            data-svg="./public/icons/map-timezones.svg"
          >
            <span class="svg-holder"></span>
          </div>
          <div class="rank-section-wrap">
            <div class="button-container">
              <button data-view="world-rank-overlay">expand full list ❯</button>
            </div>
            <div class="rank-content" id="rank-preview"></div>
          </div>
          <footer>
            <button class="overlay-open-btn" data-view="more-about-world">
              more about ▴
            </button>
          </footer>
        </div>
      </section>
      <!--
      =======================
      recap section
      =======================
      -->
      <section id="recap-lock" class="view">
        <div class="content">
          <div class="recap-lock-content">
            <div class="recap-graphic" data-svg="./public/icons/lock.svg">
              <span class="svg-holder"></span>
              <div class="recap-text">
                <p>
                  <span style="font-weight: 500"
                    >This is page is not available yet.</span
                  >
                  <br /><span class="specifics-recap"
                    >Results will be visibile once the polls are closed.</span
                  >
                </p>
              </div>
            </div>
          </div>
          <div class="timer-section-wrap">
            <div class="timer-content"><p>Voting is still happening at the moment. <br>Final results will be visibile once the polls close in:</p></div>
          </div>
        </div>

        <footer>
          <button class="overlay-open-btn" id="overlay-align-btn">
            <a href="./timeout.html" style="text-decoration: none">
              <div class="powered-by">
                Powered by&nbsp;<span
                  style="letter-spacing: -3%; font-weight: 200"
                  >SYNCHRO</span
                >
              </div></a
            >
          </button>
        </footer>
      </section>

      <!--
      =======================
      recap unlocked section
      =======================
      -->
      <section id="recap-unlock" class="view">
        <div class="content">
          <div class="recap-unlock-content">
            <div class="time-change-wrap">
              <div class="number-wrap">
                <div class="name-tag">previous time</div>
                <div class="number-small" id="system-time">00:00</div>
              </div>
              <div class="number-wrap">
                <div class="name-tag">current time</div>
                <div class="number-big" id="new-time">00:00</div>
              </div>
            </div>
          </div>
          <div class="final-score-wrap">
            <div class="final-score-content">
              <div class="number-wrap final-score-half">
                <div class="name-tag">your final score</div>
                <div class="number-big" id="final-score">
                  00,0<span style="font-size: 3rem">%</span>
                </div>
              </div>

              <div class="graphics-wrap final-score-half">
                <button
                  class="graphics-inner-wrap"
                  data-svg="./public/icons/raggiera.svg"
                >
                  <span class="svg-holder"></span>
                  <div class="name-tag">personal vote</div>
                </button>
                <button
                  class="graphics-inner-wrap"
                  data-svg="./public/icons/raggiera.svg"
                >
                  <span class="svg-holder"></span>
                  <div class="name-tag">country average</div>
                </button>
              </div>
            </div>
          </div>
        </div>

        <footer>
          <button
            class="overlay-button-align"
            id="your-vote-btn"
            data-view="final-vote-overlay"
          >
            see full comparison ❯
          </button>
        </footer>
      </section>

      <!--
        =============== SUBSECTIONS ===============
        -->

      <!-- overlay pagina alingment : personal -->
      <section
        id="align-personal-overlay"
        class="subsection view move-in-side align-subsection"
      >
        <div class="upper-content-wrap">
          <div class="recap-lock-content">
            <div class="view-graphic">
              <button class="close-subsection" data-view="alignment">❮</button>
              <div class="graphic-wrap">
                <div class="holder ext" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
                <div class="holder int" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
              </div>
            </div>
            <div class="view-score">00,0%</div>
          </div>
          <div class="comment-overlay-section-wrap">
            <div class="comment-content">
              <i>personal</i>
              Here we're gonna place the comments about the score that the
              person's measure has determined
            </div>
          </div>
        </div>
      </section>

      <!-- overlay pagina alingment :country -->
      <section
        id="align-country-overlay"
        class="subsection view move-in-side align-subsection"
      >
        <div class="upper-content-wrap">
          <div class="recap-lock-content">
            <div class="view-graphic">
              <button class="close-subsection" data-view="alignment">❮</button>
              <div class="graphic-wrap">
                <div class="holder ext" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
                <div class="holder int" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
              </div>
            </div>
            <!-- valore di partenza dell'Italia poi aggiornato con dati reali -->
            <div class="view-score">74,3%</div>
          </div>
          <div class="comment-overlay-section-wrap">
            <div class="comment-content">
              <i>country</i>
              Here we're gonna place the comments about the score that the
              person's measure has determined
            </div>
          </div>
        </div>
      </section>

      <!-- overlay pagina wolrd : ranking complete-->
      <section
        id="world-rank-overlay"
        class="subsection view world-subsection move-in-side"
      >
        <div class="upper-content-wrap">
          <div class="rank-header-content">
            <button id="close-align-recap-btn" data-view="world">❮</button>
            <div class="header-text">full rank</div>
          </div>
          <div class="rank-section-wrap">
            <div class="search-wrap">
              <input type="search" placeholder="Search for country..." />
              <button id="search-btn" data-svg="./public/icons/search.svg">
                <div class="svg-holder"></div>
              </button>
            </div>
            <div class="rank-content" id="complete-list">
              <!--<div class="line-ranking">
                <div class="name-position">
                  <div class="rank-position">#001</div>
                  <div class="country-name">Democratic Republic of Congo</div>
                </div>
                <div class="country-rank-score">87,5%</div>
              </div>-->
            </div>
          </div>
        </div>
      </section>

      <!-- overlay pagina recap unlocked : comparison votes -->
      <section id="final-vote-overlay" class="subsection view move-in-side">
        <div class="upper-content-wrap">
          <div class="rank-header-content">
            <button id="close-vote-recap-btn" data-view="recap-unlock">
              ❮
            </button>
            compared measures
          </div>
          <div class="rank-section-wrap">
            <div class="rank-content" id="measure-compare"></div>
          </div>
        </div>
      </section>

      <!--more about / align page -->
      <section
        id="more-about-personal"
        class="more-about view align-subsection"
      >
        <div class="upper-content-wrap">
          <div class="recap-lock-content">
            <div class="view-graphic">
              <div class="graphic-wrap">
                <div class="holder ext" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
                <div class="holder int" data-svg="./public/icons/raggiera.svg">
                  <span class="svg-holder"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="comment-overlay-section-wrap">
            <div class="comment-content">
              <i>What is the alignment?</i>
              <p style="font-weight: 300; text-align: justify">
                The
                <span style="font-weight: 800" class="hl-sweep"
                  >external circle</span
                >
                shows the average of alignment of your country, based on all the
                current votes. This gives an idea of percentage of citizen who
                have already registered their measure is aligned with everyone
                else's.
                <br />
                <br />The
                <span style="font-weight: 800" class="hl-sweep"
                  >internal circle</span
                >
                shows your percentage of alignment at this moment, based on all
                the current votes of your country.
                <br />
                <br />Your personal score will keep on updating based on
                everyone's measure till polls are closed. <br />The value shown
                will be your final score and contribution to the definition of
                the global rank.
              </p>
            </div>
          </div>
        </div>
        <footer>
          <button
            class="overlay-button-align"
            id="your-vote-btn"
            data-view="alignment"
          >
            close ▾
          </button>
        </footer>
      </section>

      <!--more about / align page -->
      <section id="more-about-world" class="more-about view align-subsection">
        <div class="upper-content-wrap">
          <div class="comment-overlay-section-wrap">
            <div class="comment-content">
              <i>more about world</i>
              <br />
              This section helps you with keeping track of how voting is going
              globally.
              <br />
              <br />The map highlights which timezone is currently winning and
              more likely to become the official one at the end of voting.
              <br />
              <br />You can see the top 10 countries in the rank at each moment.
              By clicking on full rank you can see every country is doing and
              their respective position.
              <br />
              <br />The country to which you contributed to with your vote is
              going to be highlighted, making it easier to spot.
            </div>
          </div>
        </div>
        <footer>
          <button
            class="overlay-button-align"
            id="your-vote-btn"
            data-view="world"
          >
            close ▾
          </button>
        </footer>
      </section>
    </main>

    <!--
        =============== OVERLAY ===============
    -->

    <div id="feedback">copied to clipboard</div>

    <!--
    =============== SCRIPTS ===============
    -->

    <!--script timer-->
    <script src="./scripts/timer.js" type="module"></script>

    <!--gestione dimensioni pagina-->
    <script src="./scripts/page-size.js" type="module"></script>

    <!--diabilita doppio tocco e zoom-->
    <script src="./scripts/unable-zoom.js"></script>

    <!--gestione overlay-->
    <script src="./scripts/overlay.js" type="module"></script>

    <!--orario di sistema-->
    <script src="./scripts/system-time.js" type="module"></script>

    <!--import svg-->
    <script src="./scripts/svg-import.js" type="module"></script>

    <!--script gestione spa-->
    <script src="./scripts/spa.js" type="module"></script>

    <!--script che genera l'elenco completo dei paesi (deve essere caricato prima di zhd-data)-->
    <script src="./scripts/complete-list-generator.js"></script>

    <!--ZHD Data Integration -->
    <script src="./scripts/zhd-data.js"></script>

    <!--Data visualization of svg Align -->
    <script src="./scripts/score-svg-display.js"></script>

    <!--Entry animation of content inside Align section -->
    <script src="./scripts/align-content-reveal.js"></script>

    <!--ricerca-->
    <script src="./scripts/search-country.js"></script>

    <!--loader - slide animation-->
    <script src="./scripts/load-page-fadeout-dissolve.js"></script>

    <script>
      /* ================================
   UNIVERSAL HIGHLIGHT SWEEP
   - Metti .hl-sweep sugli span
   - Il contenitore diventa "open" quando ha .active (default)
================================ */

      (function () {
        // 1) Contenitori che, quando diventano "attivi", devono triggerare l'animazione
        //    Nel tuo progetto: .view è perfetto
        const CONTAINER_SELECTOR = ".view";

        // 2) Regola per dire "questo container è aperto/visibile"
        //    Default: presenza della classe .active
        const isOpen = (el) => el.classList.contains("active");

        // 3) Target dentro al container
        const TARGET_SELECTOR = ".hl-sweep";

        function resetTargets(container) {
          container.querySelectorAll(TARGET_SELECTOR).forEach((t) => {
            t.classList.remove("hl-animating");
          });
        }

        function playTargets(container) {
          const targets = container.querySelectorAll(TARGET_SELECTOR);
          if (!targets.length) return;

          // reset -> reflow -> play (ri-trigger affidabile)
          targets.forEach((t) => t.classList.remove("hl-animating"));
          void container.offsetHeight;
          targets.forEach((t) => t.classList.add("hl-animating"));
        }

        // Stato precedente per evitare loop (come abbiamo fatto prima)
        const state = new WeakMap();

        function initContainer(container) {
          state.set(container, isOpen(container));

          // se parte già aperto
          if (isOpen(container)) playTargets(container);

          const obs = new MutationObserver(() => {
            const prev = state.get(container);
            const now = isOpen(container);

            if (now !== prev) {
              state.set(container, now);
              if (now) playTargets(container);
              else resetTargets(container);
            }
          });

          obs.observe(container, {
            attributes: true,
            attributeFilter: ["class"],
          });
        }

        document.querySelectorAll(CONTAINER_SELECTOR).forEach(initContainer);
      })();
    </script>
  </body>
</html>